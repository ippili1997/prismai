import{_ as $}from"./AuthenticatedLayout-CEEWPpBo.js";import{q as w,g as r,o as n,a as d,d as g,h as A,w as c,b as e,l as v,f as u,t as i,F as m,s as k,i as _,x as y,y as B}from"./app-Kyz17IOw.js";import{P as U}from"./PrimaryButton-BO-x8j6s.js";import"./ApplicationLogo-BRwB8erY.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const N={class:"flex items-center justify-between"},H={class:"text-sm text-gray-600 mt-1"},T={class:"flex space-x-2"},D={key:0,class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},I={key:1},L={key:2},q={class:"py-12"},E={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},G={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},K={class:"p-4 border-b border-gray-200"},O={class:"flex items-center space-x-2 text-sm"},J={class:"p-6"},Q={key:0,class:"text-center py-12"},R={key:1,class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},W={class:"min-w-full divide-y divide-gray-300"},X={class:"bg-white divide-y divide-gray-200"},Y=["onClick"],Z={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},ee={class:"flex items-center"},te={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},se={class:"flex items-center"},oe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ae={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},re={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},ne=["onClick"],le=["onClick"],he={__name:"Index",props:{files:Array,folders:Array,activeBucket:Object,currentPath:String,breadcrumb:Array},setup(l){const p=l,b=w(null),x=w(!1),f=w(0),C=s=>{y.get(route("files.index",{prefix:s}))},F=()=>{if(p.currentPath){const s=p.currentPath.split("/").filter(o=>o);s.pop();const t=s.length>0?s.join("/")+"/":"";y.get(route("files.index",{prefix:t}))}},M=()=>{b.value.click()},j=async s=>{const t=Array.from(s.target.files);if(t.length===0)return;let o=0,a=[];for(const h of t)try{await P(h),o++}catch{a.push(h.name)}s.target.value="",o>0?y.reload({only:["files","folders"],onSuccess:()=>{a.length>0&&alert(`${o} file(s) uploaded successfully. Failed to upload: ${a.join(", ")}`)}}):a.length>0&&alert(`Failed to upload: ${a.join(", ")}`)},P=async s=>{x.value=!0,f.value=0;try{const t=await B.post(route("files.upload-url"),{filename:s.name,content_type:s.type||"application/octet-stream",prefix:p.currentPath}),{upload_url:o,key:a}=t.data;await B.put(o,s,{headers:{"Content-Type":s.type||"application/octet-stream"},onUploadProgress:h=>{f.value=Math.round(h.loaded*100/h.total)}})}catch(t){throw console.error("Upload failed:",t),console.error("Error details:",t.response),alert("Upload error: "+(t.response?.data?.error||t.response?.data?.message||t.message)),t}finally{x.value=!1,f.value=0}},V=s=>{window.location.href=route("files.download",{bucket:p.activeBucket.id,key:s.path})},z=s=>{confirm(`Are you sure you want to delete ${s.name}?`)&&y.delete(route("files.destroy",{bucket:p.activeBucket.id,key:s.path}),{preserveState:!0,preserveScroll:!0})},S=s=>{if(s===0)return"0 Bytes";const t=1024,o=["Bytes","KB","MB","GB"],a=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,a)).toFixed(2))+" "+o[a]};return(s,t)=>(n(),r(m,null,[d(g(A),{title:"Files"}),d($,null,{header:c(()=>[e("div",N,[e("div",null,[t[0]||(t[0]=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Files ",-1)),e("p",H," Browsing: "+i(l.activeBucket.name)+" ("+i(l.activeBucket.provider)+") ",1)]),e("div",T,[d(U,{onClick:M,disabled:x.value},{default:c(()=>[x.value?_("",!0):(n(),r("svg",D,t[1]||(t[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"},null,-1)]))),x.value?(n(),r("span",I,"Uploading... "+i(f.value)+"%",1)):(n(),r("span",L,"Upload Files"))]),_:1},8,["disabled"]),d(g(v),{href:s.route("buckets.index"),class:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-25 transition ease-in-out duration-150"},{default:c(()=>t[2]||(t[2]=[u(" Manage Buckets ",-1)])),_:1,__:[2]},8,["href"])])])]),default:c(()=>[e("div",q,[e("div",E,[e("div",G,[e("div",K,[e("nav",O,[d(g(v),{href:s.route("files.index"),class:"text-gray-600 hover:text-gray-900"},{default:c(()=>[u(i(l.activeBucket.name),1)]),_:1},8,["href"]),(n(!0),r(m,null,k(l.breadcrumb,(o,a)=>(n(),r(m,{key:a},[t[3]||(t[3]=e("span",{class:"text-gray-400"},"/",-1)),d(g(v),{href:s.route("files.index",{prefix:o.path}),class:"text-gray-600 hover:text-gray-900"},{default:c(()=>[u(i(o.name),1)]),_:2},1032,["href"])],64))),128))])]),e("div",J,[l.files.length===0&&l.folders.length===0?(n(),r("div",Q,t[4]||(t[4]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})],-1),e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No files",-1),e("p",{class:"mt-1 text-sm text-gray-500"},"This folder is empty.",-1)]))):(n(),r("div",R,[e("table",W,[t[11]||(t[11]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Name "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Size "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Modified "),e("th",{scope:"col",class:"relative px-6 py-3"},[e("span",{class:"sr-only"},"Actions")])])],-1)),e("tbody",X,[l.currentPath?(n(),r("tr",{key:0,class:"hover:bg-gray-50 cursor-pointer",onClick:F},t[5]||(t[5]=[e("td",{class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},[e("div",{class:"flex items-center"},[e("svg",{class:"h-5 w-5 text-gray-400 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})]),u(" .. ")])],-1),e("td",{class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},"-",-1),e("td",{class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},"-",-1),e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},null,-1)]))):_("",!0),(n(!0),r(m,null,k(l.folders,o=>(n(),r("tr",{key:o.path,class:"hover:bg-gray-50 cursor-pointer",onClick:a=>C(o.path)},[e("td",Z,[e("div",ee,[t[6]||(t[6]=e("svg",{class:"h-5 w-5 text-blue-500 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})],-1)),u(" "+i(o.name),1)])]),t[7]||(t[7]=e("td",{class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},"-",-1)),t[8]||(t[8]=e("td",{class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},"-",-1)),t[9]||(t[9]=e("td",{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},null,-1))],8,Y))),128)),(n(!0),r(m,null,k(l.files,o=>(n(),r("tr",{key:o.path,class:"hover:bg-gray-50"},[e("td",te,[e("div",se,[t[10]||(t[10]=e("svg",{class:"h-5 w-5 text-gray-400 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),u(" "+i(o.name),1)])]),e("td",oe,i(S(o.size)),1),e("td",ae,i(o.last_modified),1),e("td",re,[e("button",{onClick:a=>V(o),class:"text-indigo-600 hover:text-indigo-900 mr-3"}," Download ",8,ne),e("button",{onClick:a=>z(o),class:"text-red-600 hover:text-red-900"}," Delete ",8,le)])]))),128))])])]))])])])]),e("input",{ref_key:"fileInput",ref:b,type:"file",multiple:"",onChange:j,class:"hidden"},null,544)]),_:1})],64))}};export{he as default};
